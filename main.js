(()=>{"use strict";let t=(t=21)=>{let e="",s=crypto.getRandomValues(new Uint8Array(t));for(;t--;){let n=63&s[t];e+=n<36?n.toString(36):n<62?(n-26).toString(36).toUpperCase():n<63?"_":"-"}return e};class e{constructor(t){this.container=t}static createCardHTML(t,e,s){return`\n    <div class="tasks-column__card" data-column ="${e}" data-id="${s}">\n      ${t}\n      <button class="tasks-column__delete-card-button hidden">X</button>\n    </div>\n    `}createCard({text:t,column:e,id:s}){this.container.insertAdjacentHTML("beforeend",this.constructor.createCardHTML(t,e,s))}}const s=document.getElementById("main");new class{constructor(t){this.container=t}init(){this.registerEvents()}registerEvents(){const t=[...document.querySelectorAll(".tasks-column__button")],e=[...document.querySelectorAll(".tasks-column__form")],s=[...document.querySelectorAll(".tasks-column__add-card-button")],n=[...document.querySelectorAll(".place-for-cards")];t.forEach((s=>{s.addEventListener("click",(s=>{const n=t.indexOf(s.currentTarget);e[n].classList.toggle("hidden")}))})),this.container.addEventListener("mouseover",(t=>{t.target.classList.contains("tasks-column__card")&&this.showDeleteCardButton(t)})),this.container.addEventListener("mouseout",(t=>{t.target.classList.contains("tasks-column__card")&&this.hideDeleteCardButton(t)})),this.container.addEventListener("mousedown",(t=>{t.target.classList.contains("tasks-column__delete-card-button")||t.target.classList.contains("tasks-column__card")&&this.onMouseDown(t)})),this.container.addEventListener("mouseup",(t=>this.onMouseUp(t))),this.container.addEventListener("mousemove",(t=>this.onMouseMove(t))),e.forEach((t=>{t.addEventListener("submit",(t=>{this.createNewCard(t)}))})),s.forEach((t=>{t.addEventListener("click",(t=>this.onClickAddCardButton(t)))})),n.forEach((t=>{t.addEventListener("click",(t=>{const{target:e}=t;e.classList.contains("tasks-column__delete-card-button")&&this.deleteCard(t)}))}))}createNewCard(s){s.preventDefault();const{currentTarget:n}=s,o=n.closest(".tasks-column"),c=o.querySelector(".place-for-cards"),r=o.querySelector(".tasks-column__input"),l=r.value,a=new e(c),i={text:l,column:c.dataset.column,id:t()};a.createCard(i),r.value=""}onClickAddCardButton(t){t.currentTarget.closest(".tasks-column").querySelector(".tasks-column__form").classList.toggle("hidden")}showDeleteCardButton(t){t.target.querySelector("button").classList.remove("hidden")}hideDeleteCardButton(t){t.target.querySelector("button").classList.add("hidden")}deleteCard(t){t.target.closest(".tasks-column__card").remove()}onMouseDown(t){t.preventDefault(),document.body.style.cursor="grabbing";const e=t.target.closest(".tasks-column__card");this.cloneEl=e.cloneNode(!0);const{width:s,height:n,left:o,top:c}=e.getBoundingClientRect();this.cloneEl.classList.add("dragged"),this.cloneEl.style.width=`${s}px`,this.cloneEl.style.height=`${n}px`,document.body.appendChild(this.cloneEl),this.coordX=t.clientX-o,this.coordY=t.clientY-c,this.cloneEl.style.top=`${c}px`,this.cloneEl.style.left=`${o}px`,this.currentEl=e,this.currentEl.classList.add("hidden")}onMouseMove(t){t.preventDefault(),this.cloneEl&&(this.cloneEl.style.left=t.pageX-this.coordX+"px",this.cloneEl.style.top=t.pageY-this.coordY+"px")}onMouseUp(t){if(t.preventDefault(),document.body.style.cursor="default",!this.currentEl||!this.cloneEl)return;const e=document.elementFromPoint(t.clientX,t.clientY).closest(".tasks-column__card"),s=t.target.closest(".tasks-column");s||(this.cloneEl.remove(),this.currentEl.classList.remove("hidden"));const n=s.querySelector(".place-for-cards");this.currentEl.dataset.column=s.dataset.column,n.insertBefore(this.currentEl,e),this.currentEl.classList.remove("hidden"),this.cloneEl.remove(),this.cloneEl=null}loadData(t){"[]"!==t&&t.forEach((t=>{const s=this.container.querySelector(`.tasks-column[data-column="${t.column}"]`).querySelector(".place-for-cards");new e(s).createCard(t)}))}}(s).init()})();